# Монтирование общей папки с правильными правами

В первую очередь, получим UID и GID для обоих пользователей:

```bash
id www-data
id rootubn
```

Теперь, когда ты знаешь UID и GID для обоих пользователей:

 **www-data:**
* UID: 33
* GID: 33

**rootubn:**
* UID: 1000
* GID: 1000

Для того чтобы оба пользователя имели доступ к общей папке, можно использовать комбинацию UID и GID для их идентификации в командной строке при монтировании папки.

**Монтируем общую папку с нужными правами:**

Укажем `uid=33` и `gid=33` для пользователя `www-data` и добавим `umask=0022`, чтобы оба пользователя могли читать и выполнять файлы, но только владельцу разрешать их изменять.

Используем следующую команду для монтирования общей папки:

```bash
sudo mount -t vboxsf -o uid=33,gid=33,umask=0022 shared /var/www/shared
```
Здесь:

`uid=33`,`gid=33` — это для пользователя `www-data`, чтобы он имел доступ.

`umask=0022` — разрешает доступ на чтение и выполнение всем пользователям, а изменения могут делать только владельцы.

**Проверяем права на папку:**

Теперь проверим, что папка монтировалась с нужными правами:

```bash
ls -ld /var/www/shared
```
Убедись, что папка имеет права типа `r-x` для всех пользователей:

```bash
drwxr-xr-x  1 www-data www-data 4096 Apr 10 16:00 /var/www/shared
```
**Даем доступ для rootubn:**

Чтобы пользователь `rootubn` имел доступ, можно добавить его в группу `www-data`, потому что `www-data` и так имеет доступ. Мы сделаем это следующим образом:

Добавим пользователя `rootubn` в группу `www-data`:

```bash
sudo usermod -aG www-data rootubn
```
Теперь для того, чтобы изменения вступили в силу, нужно либо выйти из системы и войти снова, либо выполнить команду:

```bash
newgrp www-data
```
Это даст `rootubn` доступ к общей папке через группу `www-data`.

**Автоматическое монтирование при старте системы**
Чтобы при старте системы общая папка монтировалась автоматически с нужными правами для пользователей `www-data` и `rootubn`, добавим запись в файл `/etc/fstab`.

Откроем файл `/etc/fstab` для редактирования:

```bash
sudo nano /etc/fstab
```
Добавим строку для монтирования общей папки, чтобы она монтировалась с правами для `www-data` и `rootubn`:

```bash
shared /var/www/shared vboxsf defaults,uid=33,gid=33,umask=0022 0 0
```
Сохраним изменения и закроем редактор.

Применим изменения:

```bash
sudo mount -a
```
Это позволит монтировать папку при старте системы с нужными правами.

**Проверка**
Теперь, после монтирования и настройки прав, оба пользователя (`www-data` и `rootubn`) должны иметь доступ к папке `/var/www/shared` без необходимости ввода пароля.

Для проверки можно сделать следующее:

Войти как `rootubn` и проверить, что папка доступна:

```bash
ls /var/www/shared
```
Проверить через `www-data` (например, с помощью команды:
```bash
sudo -u www-data ls /var/www/shared
```
или через веб-сервер Nginx), чтобы убедиться, что доступ есть.
Опция `-u` в команде sudo позволяет указать пользователя, от имени которого должна быть выполнена команда.